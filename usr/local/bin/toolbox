#!/usr/bin/env python3
import sys
import os
import importlib
import argparse

# Ajoute le chemin du répertoire contenant 'modules' au sys.path
sys.path.append(os.path.join(os.path.dirname(__file__), 'modules'))

def main():
    parser = argparse.ArgumentParser(description="Outil CLI pour générer des QR codes et autres fonctions modulaires.")
    parser.add_argument("module", help="Nom du module à exécuter.")

    # Ajoute un argument pour accepter les options de module
    parser.add_argument("args", nargs="*", help="Arguments positionnels pour le module.")

    # Analyse les arguments de la ligne de commande
    args = parser.parse_args()

    module_name = args.module
    module_args = args.args

    # Tenter de charger le module
    try:
        module = importlib.import_module(module_name)

        # Vérifier si la fonction run existe dans le module
        if hasattr(module, 'run'):
            module.run(*module_args)  # Passer les arguments en utilisant unpacking
        else:
            print(f"Le module '{module_name}' ne contient pas de fonction 'run'.")
    except ImportError as e:
        print(f"Erreur d'importation : {e}")
        print(f"Module '{module_name}' introuvable.")

if __name__ == "__main__":
    main()
